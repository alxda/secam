kind: pipeline
name: build:tensorflow

platform:
  os: linux
  arch: arm

clone:
  depth: 1

steps:
- name: submodules
  image: docker:git
  commands:
    - git submodule update --init
- name: build:tensorflow
  image: plugins/docker:linux-arm
  group: build
  settings:
    repo: alxda/secam
    dry_run: true
    dockerfile: ./rpi-tensorflow/Dockerfile
- name: publish:tensorflow
  image: plugins/docker:linux-arm
  repo: alxda/secam
  tags:
    - latest
  dockerfile: ./rpi-tensorflow/Dockerfile    
  secrets: [ docker_username, docker_password ]

---
kind: pipeline
name: build:node-red

platform:
  os: linux
  arch: arm

clone:
  depth: 1

steps:
- name: submodules
  image: docker:git
  commands:
    - git submodule update --init
- name: build:node-red
  image: plugins/docker:linux-arm
  group: build
  settings:
    repo: alxda/secam
    dry_run: true
    dockerfile: ./rpi-node-red/Dockerfile
- name: publish:node-red
  image: plugins/docker:linux-arm
  pull: true
  secrets: [ docker_username, docker_password ]
  group: docker
  settings:
    repo: alxda/secam
    dockerfile: ./rpi-node-red/Dockerfile
    tags: latest